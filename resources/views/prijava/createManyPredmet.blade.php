@extends('layouts.layout')
@section('page_heading','??????? ????????? ?? ??????? ???????')
@section('section')
    <div class="col-lg-12">
        <div id="messages">
            @if (Session::get('flash-error'))
                <div class="alert alert-dismissible alert-danger">
                    <button type="button" class="close" data-dismiss="alert">×</button>
                    <strong>??????!</strong>
                    @if(Session::get('flash-error') === 'update')
                        ????? ?? ?? ?????? ??? ?????? ????????! ?????? ??? ????????? ??????.
                    @elseif(Session::get('flash-error') === 'delete')
                        ????? ?? ?? ?????? ??? ??????? ????????! ?????? ??? ????????? ??????.
                    @elseif(Session::get('flash-error') === 'upis')
                        ????? ?? ?? ?????? ??? ????? ?????????! ?????? ??? ????????? ?? ?? ?? ???????? ???????
                        ????????? ? ????????? ??????.
                    @endif
                </div>
            @elseif(Session::get('flash-success'))
                <div class="alert alert-dismissible alert-success">
                    <button type="button" class="close" data-dismiss="alert">×</button>
                    <strong>?????!</strong>
                    @if(Session::get('flash-success') === 'update')
                        ?????? ? ????????? ?? ??????? ????????.
                    @elseif(Session::get('flash-success') === 'delete')
                        ?????? ? ????????? ?? ??????? ????????.
                    @elseif(Session::get('flash-success') === 'upis')
                        ???? ????????? ?? ??????? ???????.
                    @endif
                </div>
            @endif
        </div>
        <ul class="nav nav-pills">
            @foreach($studijskiProgrami as $program)
                <li role="presentation"
                        {{ Request::input('studijskiProgramId') == $program->id  ? 'class=active' : '' }}>
                    <a href="?studijskiProgramId={{ $program->id }}">{{ $program->naziv }}</a>
                </li>
            @endforeach
        </ul>
        <hr>
        <form id="formaKandidatiOdabir" action="" method="post">
            {{ csrf_field() }}
            <table id="tabela" class="table">
                <thead>
                <th></th>
                <th>???</th>
                <th>???????</th>
                <th>????</th>
                <th>?????? ???????</th>
                <th>??????</th>
                </thead>
                <tbody>
                @foreach($kandidati as $index => $kandidat)
                    <tr>
                        <td><input type="checkbox" id="odabir" name="odabir[{{ $index }}]" value="{{ $kandidat->id }}">
                        </td>
                        <td>{{$kandidat->imeKandidata}}</td>
                        <td>{{$kandidat->prezimeKandidata}}</td>
                        <td>{{$kandidat->jmbg}}</td>
                        <td>{{$kandidat->godinaStudija->nazivRimski}}</td>
                        <td>
                            <a class="btn btn-warning" href="{{$putanja}}/kandidat/{{ $kandidat->id }}/edit">
                                <div title="??????">
                                    <span class="fa fa-edit"></span>
                                </div>
                            </a>
                            <a class="btn btn-danger" href="{{$putanja}}/kandidat/{{ $kandidat->id }}/delete"
                               onclick="return confirm('?? ?? ??? ??????? ?? ?????? ?? ???????? ??????? ???? ??????????');">
                                <div title="???????">
                                    <span class="fa fa-trash"></span>
                                </div>
                            </a>
                            <a class="btn btn-success btn-sm" href="{{$putanja}}/kandidat/{{ $kandidat->id }}/upis">
                                ???? ?????????
                            </a>
                        </td>
                    </tr>
                @endforeach
                </tbody>
            </table>
        </form>
        <br/>
        <hr>
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h3 class="panel-title">?? ???????? ?????????</h3>
            </div>
            <div class="panel-body">
                <div class="form-group">
                    {{--<div id="masovnaUplata" class="btn btn-primary">???????? ?????????</div>--}}
                    <div id="masovniUpis" class="btn btn-success">?????? ????</div>
                </div>
            </div>
        </div>

        <div class="panel panel-primary">
            <div class="panel-heading">
                <h3 class="panel-title">???????? ???? ?????</h3>
            </div>
            <div class="panel-body">
                {{ csrf_field() }}
                <div class="form-group">
                    <a class="btn btn-primary pull-left" target="_blank"
                       href="{{$putanja}}/izvestaji/spisakPoSmerovima">????????? ????????</a>
                </div>
            </div>
        </div>
    </div>
    <script>
        var forma = $('#formaKandidatiOdabir');

        $('#masovnaUplata').click(function () {
            forma.attr("action", "{{ $putanja }}/kandidat/masovnaUplata");
            forma.submit();
        });

        $('#masovniUpis').click(function () {
            forma.attr("action", "{{ $putanja }}/kandidat/masovniUpis");
            forma.submit();
        });

        $(document).ready(function () {
            $('#tabela').dataTable({
                "aaSorting": [],
                "columnDefs": [
                    {"orderable": false, "targets": [0, 5]}
                ],
                "oLanguage": {
                    "sProcessing": "??????????? ? ????...",
                    "sLengthMenu": "??????? _MENU_ ?????????",
                    "sZeroRecords": "???? ???????? ??????? ????????",
                    "sInfo": "?????? _START_ ?? _END_ ?? ?????? _TOTAL_ ?????????",
                    "sInfoEmpty": "?????? 0 ?? 0 ?? ?????? 0 ?????????",
                    "sInfoFiltered": "(?????????? ?? ?????? _MAX_ ?????????)",
                    "sInfoPostFix": "",
                    "sSearch": "????????:",
                    "sUrl": "",
                    "oPaginate": {
                        "sFirst": "???????",
                        "sPrevious": "?????????",
                        "sNext": "???????",
                        "sLast": "????????"
                    }
                }
            });
        });
    </script>
@endsection
